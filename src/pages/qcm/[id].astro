---
import Layout from '../../layouts/Layout.astro';
import QCMPlayer from '../../components/QCMPlayer.svelte';
import { loadAllQCMs } from '../../lib/qcmParser';

export async function getStaticPaths() {
  const allQCMs = await loadAllQCMs();
  return allQCMs.map((qcm) => ({
    params: { id: qcm.frontmatter.id },
    props: { qcm },
  }));
}

const { qcm } = Astro.props;
---

<Layout
  title={`${qcm.frontmatter.titre} - ${qcm.frontmatter.matiere} ${qcm.frontmatter.niveau}`}
  description={qcm.frontmatter.description}
>
  <div class="mb-8 text-center">
    <a
      href={import.meta.env.BASE_URL + 'selection'}
      class="inline-block rounded-xl bg-gray-200 px-6 py-3 text-lg font-semibold text-gray-700 transition-all hover:bg-gray-300"
    >
      ← Retour aux matières
    </a>
  </div>

  <QCMPlayer qcm={qcm} client:load />
</Layout>
